import{Y as l,d as p,h as g}from"./preview-552af32d.js";import"./iframe-4930a99e.js";import"../sb-preview/runtime.js";import"./chunk-DMDGLPPZ-219a4511.js";class C{constructor(t){this.chartCtx=t}drawGridLine(t,i,h,a,s="#d1d1d1"){this.chartCtx.save(),this.chartCtx.strokeStyle=s,this.chartCtx.beginPath(),this.chartCtx.moveTo(t,i),this.chartCtx.lineTo(h,a),this.chartCtx.stroke(),this.chartCtx.restore()}}class v{constructor(t){this.chartCtx=t}addLabel(t,i,h,a){this.chartCtx.save(),this.chartCtx.font="12px",this.chartCtx.fillStyle="#4f4f4f",a?(this.chartCtx.textBaseline="middle",this.chartCtx.textAlign="right",this.chartCtx.fillText(t,i,h)):(this.chartCtx.textAlign="center",this.chartCtx.fillText(t,i,h+4)),this.chartCtx.restore()}getLabelScale(t,i,h){let a=this.calculateScale(t,i,h);return a===i?a=this.calculateScale(t,i-1,h):a}calculateScale(t,i,h){if(t<12){for(let a=2;a<=i;a++)if(i%a===0&&t*a*h>12)return a}else return 1}}class x{constructor(t,i,h,a){this.chartCanvas=t,this.chartCtx=i,this.data=h,this.options=a,this.scale=1,this.paddingTopBottom=16,this.paddingLeftRight=24,this.gutterSpace=8,this.commonShapes=new C(i),this.textUtil=new v(i)}drawChart(){try{const t=Math.max(...Object.values(this.data)),i=Object.values(this.data),h=Object.keys(this.data),a=(this.chartCanvas.width-(this.paddingTopBottom+this.paddingLeftRight))/i.length,s=(this.chartCanvas.height-(this.paddingTopBottom+this.paddingLeftRight))/t,r=i.length*a/this.chartCanvas.width,e=t*s/this.chartCanvas.height;this.scale=this.textUtil.getLabelScale(s,t+2,e),this.drawGrid(t+2,a,s,r,e,i),this.addLabels(t+2,a,s,r,e,h);for(let n in i){const d=this.paddingLeftRight+this.gutterSpace+a*parseInt(n)*r,c=this.paddingTopBottom+((t+2)*s-i[n]*s)*e;this.drawChartBar(d,c,(a-this.gutterSpace*2)*r,i[n]*s*e)}}catch(t){console.log("%c Chart draw error ","background: #BA1A1A; color: #fff; padding: 2px;",t)}}drawGrid(t,i,h,a,s,r){const e=r.length*i*a+this.paddingLeftRight,n=t*h*s;this.commonShapes.drawGridLine(this.paddingLeftRight,this.paddingTopBottom,this.paddingLeftRight,n+this.paddingTopBottom),this.commonShapes.drawGridLine(this.paddingLeftRight,n+this.paddingTopBottom,e,n+this.paddingTopBottom)}addLabels(t,i,h,a,s,r){for(let e=0;e<t+2;e++)if(e%this.scale===0){const n=(this.paddingLeftRight-this.gutterSpace)*a,d=(t-e)*h*s+this.paddingTopBottom;this.textUtil.addLabel(`${e}`,n,d,!0),this.commonShapes.drawGridLine(n+this.gutterSpace/2,d,i*r.length*a+this.paddingLeftRight,d,"#d1d1d1")}for(let e in r){const n=this.paddingLeftRight+this.gutterSpace+i*parseInt(e)+i*a/2,d=this.paddingTopBottom*2+t*h*s,c=i*(parseInt(e)+1)*a+this.paddingLeftRight;this.textUtil.addLabel(r[e],n*a,d,!1),this.commonShapes.drawGridLine(c,this.paddingTopBottom,c,t*h*s+this.paddingTopBottom,"#d1d1d1")}}drawChartBar(t,i,h,a){var s;let r="#e9488b";!((s=this.options)===null||s===void 0)&&s.color&&(r=this.options.color),this.chartCtx.save(),this.chartCtx.fillStyle=r,this.chartCtx.fillRect(t,i,h,a),this.chartCtx.restore()}}const L=class{constructor(o){l(this,o),this.data=void 0,this.options=void 0}componentDidLoad(){var o,t;!((o=this.options)===null||o===void 0)&&o.height&&(!((t=this.options)===null||t===void 0)&&t.width)?(this.chartCanvas.height=this.options.height,this.chartCanvas.width=this.options.width):(this.chartCanvas.height=300,this.chartCanvas.width=300),this.initResizeObserver(),this.chartCtx=this.chartCanvas.getContext("2d"),this.drawBasicBarChart()}componentDidUpdate(){this.drawBasicBarChart()}drawBasicBarChart(){this.clearCanvas(),new x(this.chartCanvas,this.chartCtx,this.data,this.options).drawChart()}initResizeObserver(){new ResizeObserver(t=>{var i;this.chartCanvas.width>t[0].contentRect.width?this.chartCanvas.width=t[0].contentRect.width:this.chartCanvas.width=((i=this.options)===null||i===void 0?void 0:i.width)|300,this.drawBasicBarChart()}).observe(this.elmnt)}clearCanvas(){this.chartCtx.save(),this.chartCtx.setTransform(1,0,0,1,0,0),this.chartCtx.clearRect(0,0,this.chartCanvas.width,this.chartCanvas.height),this.chartCtx.restore()}render(){return p("canvas",{ref:o=>this.chartCanvas=o,id:this.elmnt.id?`solias-canvas-${this.elmnt.id}`:""})}get elmnt(){return g(this)}};export{L as solias_chart};
//# sourceMappingURL=p-c4b8b73a.entry-3cfba2d4.js.map
